<!DOCTYPE html>
<html>
<body>
	<input type="text" id="serverUrl" value="ws://localhost:9002"/>
	<button id="connectButton">Open</button>
	<button id="disconnectButton">Close</button>
	<input type="text" id="sendMessage" value="Hello there."/>
	<button id="sendButton">Send</button>
	<button id="imageButton">Image</button>
	<div id="messages"></div>
	<img id="img" src="https://www.google.de/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google" width="272" height="92">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
	<script>
		new function() {
			var ws = null;
			var serverUrl;
			var connectButton;
			var disconnectButton; 
			var sendButton;
			var counter = 0;

			var open = function() {
				ws = new WebSocket(serverUrl.val());
			}
			
			var close = function() {
				if (ws) {
					ws.close();
				}
			}
			
			var addMessage = function(data) {
				var messages = $('#messages');
				messages.append(data);
			}
			
			function show_image(src, width, height, alt) {
				//var img = document.createElement("img");
				var img = document.getElementById("img");
				
				img.src = src;
				img.width = width;
				img.height = height;
				img.alt = alt;

				// This next line will just add it to the <body> tag
				//document.body.appendChild(img);
			}
			
			function switch_image() {
				if (counter == 0) {
					show_image("https://pbs.twimg.com/profile_images/868147475852312577/fjCSPU-a_400x400.jpg", 400, 400, "reddit");
					counter = 1;
				} else {
					show_image("https://www.google.de/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png", 272, 92, "google");
					counter = 0;
				}
			}
				
			WebSocketClient = {
		init: function() {
			serverUrl = $('#serverUrl');
			connectButton = $('#connectButton');
			disconnectButton = $('#disconnectButton'); 
			sendButton = $('#sendButton');
			imageButton = $('#imageButton');
			
			connectButton.click(function(e) {
				ws = new WebSocket(serverUrl.val());
				ws.onmessage = function(evt) {
					if ($('#sendMessage').val() == "image") {
						//addMessage(evt.data)
						show_image('data:image/bmp;base64, ' + evt.data, 220, 165, 'image')
					} else {
						addMessage(evt.data)
					}
				}
			});
		
			disconnectButton.click(function(e) {
				if (ws) {
					ws.close();
				}
			});
					
					sendButton.click(function(e) {
						var msg = $('#sendMessage').val();
						ws.send(msg);
					});
					
					imageButton.click(function(e) {
						switch_image();
					});
				}
			};
		}

		$(function() {
			WebSocketClient.init();
		});
</script>
</body>
</html>